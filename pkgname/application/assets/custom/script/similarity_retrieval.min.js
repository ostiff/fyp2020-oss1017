const domain=document.location.origin,data_url=domain+"/get_data",KDTree_url=domain+"/get_k_nearest",encPatient_url=domain+"/enc_patient";let N=0;async function getData(e){let t=await fetch(e);return await t.json()}function updatePage(e){let t=document.getElementById("tableSummary");getData(e).then(e=>{let a=Array(N).fill("#1f77b4");for(let t=0;t<e.idx[0].length;t++)a[e.idx[0][t]]="#ff7f0e";let n={marker:{color:a}};Plotly.restyle("scatterPlot",n,0),t.innerHTML=e.table})}function encPatient(){let e=document.getElementById("encode-form"),t=new URL(encPatient_url);t.searchParams.append("k",$("#selectK").slider("option","value"));let a=["age","weight","plt","hct","b_temp"];for(let n=0;n<e.length-1;n++)t.searchParams.append(a[n],e.elements[n].value);updatePage(t)}function resizePlot(){let e=$("#scatterPlot").parent().width(),t=$("#scatterPlot").parent().height();Plotly.relayout("scatterPlot",{width:e,height:t})}async function main(){const e=await getData(data_url);N=e.x.length;let t={x:e.x,y:e.y,mode:"markers",type:"scatter",marker:{color:"#1f77b4"}};Plotly.newPlot("scatterPlot",[t],{hovermode:"closest",title:"Auto-Encoder - Latent dimension",margin:{t:50,l:50,r:50,b:50}}),window.addEventListener("resize",resizePlot),$(".sidebar-toggle").click(function(){resizePlot()});let a=document.getElementById("scatterPlot"),n=$("#selectK").slider("option","value");$("#selectK").slider({max:N-1}),$("#listenSlider").change(function(){$(".output b").text(this.value),n=this.value}),a.on("plotly_click",function(e){let t=e.points[0].pointIndex,a=new URL(KDTree_url);a.searchParams.append("id",t),a.searchParams.append("k",n),updatePage(a)});let l=$("#encode-form");l.validate({errorContainer:l.find("div.validation-message"),errorLabelContainer:l.find("div.validation-message ul"),wrapper:"li"})}main();