
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "_examples/som/plot_som_labels_04.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download__examples_som_plot_som_labels_04.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr__examples_som_plot_som_labels_04.py:


Plot SOM w/ Labelling
=====================

Project labels onto Node difference map.

The standard deviation of the clusters in the dataset was increased compared
to :ref:`sphx_glr__examples_som_plot_som_sample_01.py` to illustrate how nodes
can host datapoints with different labels.

.. GENERATED FROM PYTHON SOURCE LINES 12-74



.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /_examples/som/images/sphx_glr_plot_som_labels_04_001.png
          :alt: Distance from neurons in the neighbourhood
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/som/images/sphx_glr_plot_som_labels_04_002.png
          :alt: Distance from neurons in the neighbourhood
          :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    The dataset has 16 dimensions and 6 clusters.

     quantization error: 0.4244843931751695






|

.. code-block:: default
   :lineno-start: 13


    # Generic libraries
    import pandas as pd
    import numpy as np

    # Other
    import matplotlib.pyplot as plt
    from matplotlib import rcParams
    from minisom import MiniSom
    from sklearn.datasets import make_blobs
    from sklearn import preprocessing

    # Utils
    from pkgname.utils.som_utils import diff_graph_hex, project_labels

    # Configuration
    rcParams.update({'figure.autolayout': True})


    # ----------------------
    # Create dataset
    # ----------------------
    SEED = 0
    N_CLUSTERS = 6
    N_SAMPLES = N_CLUSTERS * 100
    N_FEATURES = 16

    # Show information
    print("The dataset has {dim} dimensions and {clusters} clusters."
          .format(dim=N_FEATURES, clusters=N_CLUSTERS))

    # Create dataset
    x, y = make_blobs(n_samples=N_SAMPLES,
                      n_features=N_FEATURES,
                      centers=N_CLUSTERS,
                      cluster_std=6,
                      random_state=SEED)

    # Scale data
    scaler = preprocessing.MinMaxScaler()
    x = scaler.fit_transform(x)

    # ----------------------
    # Train SOM
    # ----------------------
    # Create SOM
    som = MiniSom(20, 20, x.shape[1],
        topology='hexagonal',
        activation_distance='euclidean',
        neighborhood_function='gaussian',
        sigma=2.5, learning_rate=.5,
        random_seed=SEED)

    # Train
    som.pca_weights_init(x)
    som.train_random(x, 1000, verbose=True)

    diff_graph_hex(som, show=True, printout=False)

    project_labels(som, x, y, show=True, printout=False)




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  1.143 seconds)


.. _sphx_glr_download__examples_som_plot_som_labels_04.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_som_labels_04.py <plot_som_labels_04.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_som_labels_04.ipynb <plot_som_labels_04.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
